<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Program Lentera Zyland: Fun LENTERA, LENTERA Focus, Zylearn, dan LENTERA Competition—terintegrasi Computational Thinking."/>
  <title>Program • Lentera Zyland</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet"/>

  <!-- Tailwind + Icons -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>

  <link rel="icon" href="/img/icon.png" type="image/png" />

  <style>
    :root{
      --primary:#16a34a; /* hijau */
      --primary-700:#15803d;
      --secondary:#facc15; /* kuning */
      --ink:#0b1220;
      --paper:#ffffff;

      --mesh1:rgba(250,204,21,.22);
      --mesh2:rgba(22,163,74,.14);
      --ring:rgba(22,163,74,.14);
    }

    /* ==== OVERFLOW SAFEGUARDS (perbaikan mobile) ==== */
    *,*::before,*::after{ box-sizing:border-box; }
    html,body{ width:100%; max-width:100%; overflow-x:hidden; }
    header,main,footer{ width:100%; overflow-x:hidden; }

    body{ font-family:'Poppins',sans-serif; color:var(--ink); background:var(--paper); }

    /* hero mesh (tanpa kolase gambar) */
    .hero{
      position:relative; isolation:isolate;
      background:
        radial-gradient(900px 450px at 100% -10%, var(--mesh1), transparent 60%),
        radial-gradient(600px 350px at -10% 100%, var(--mesh2), transparent 60%);
      /* clip dekorasi supaya tidak nambah lebar layar */
      overflow:hidden;
    }
    .blob { position:absolute; inset:0; z-index:-1; pointer-events:none; overflow:hidden; }
    .blob::before, .blob::after{
      content:""; position:absolute; border-radius:9999px; filter: blur(60px); opacity:.6;
    }
    .blob::before{ width:320px; height:320px; top:-40px; left:-40px; background:var(--secondary); }
    .blob::after { width:380px; height:380px; bottom:-60px; right:-60px; background:#86efac; }

    /* micro-interactions */
    .card-hover{ transition:transform .28s ease, box-shadow .28s ease; }
    .card-hover:hover{ transform:translateY(-4px); }

    /* chips / filters */
    .chip{ cursor:pointer; user-select:none; }
    .chip-active{
      background:rgba(250,204,21,0.25);
      border-color:rgba(250,204,21,0.55) !important;
      color:#92400e;
    }

    /* accordion */
    details.program{
      border:1px solid #f3f4f6; /* gray-100 */
      border-radius:1rem;
      background:#fff;
      overflow:hidden;
    }
    details.program[open] .chev{ transform: rotate(180deg); }
    .chev{ transition: transform .25s ease; }

    /* CT badge */
    .chip-ct{
      background: rgba(22,163,74,.08);
      border:1px solid rgba(22,163,74,.18);
      color:#065f46;
    }

    /* Gallery */
    /* ganti outline yang bisa menambah lebar jadi inset shadow yang tidak mengubah layout */
    .thumb-active{ outline:none; box-shadow: inset 0 0 0 3px var(--secondary), 0 0 0 1px rgba(0,0,0,.04); }

    @media (prefers-reduced-motion:no-preference){
      .reveal{ opacity:0; transform:translateY(14px); transition:opacity .6s ease, transform .6s ease; }
      .reveal.show{ opacity:1; transform:translateY(0); }
    }
  </style>
</head>
<body class="antialiased text-gray-800 selection:bg-yellow-200 selection:text-gray-900 overflow-x-hidden">

  <!-- Header -->
  <header class="sticky top-0 z-50 bg-white/90 backdrop-blur border-b border-gray-100">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <!-- Branding -->
        <a href="/" class="inline-flex items-center gap-2 group" aria-label="Beranda">
          <span class="inline-block h-8 w-1.5 rounded-full" style="background:var(--secondary)"></span>
          <span class="font-[Lobster] text-2xl leading-none text-gray-900">Lentera Zyland</span>
          <span class="ml-1 text-xs px-2 py-0.5 rounded-full border border-yellow-300 text-yellow-700 bg-yellow-50 hidden sm:inline-block">PKM</span>
        </a>

        <!-- Nav -->
        <nav class="hidden md:flex items-center gap-6">
          <a href="/" class="text-sm font-medium text-gray-700 hover:text-gray-900 transition">Home</a>
          <a href="/berita" class="text-sm font-medium text-gray-700 hover:text-gray-900 transition">Berita</a>
          <a href="/program" class="text-sm font-semibold text-gray-900 underline underline-offset-8 decoration-yellow-300">Program</a>
          <a href="/download" class="text-sm font-medium text-gray-700 hover:text-gray-900 transition">Download</a>
          <a href="/tentang" class="text-sm font-medium text-gray-700 hover:text-gray-900 transition">Tentang</a>
        </nav>

        <!-- CTA -->
        <div class="hidden md:flex items-center gap-3">
          <a href="https://instagram.com/lenterazyland" target="_blank" rel="noopener"
             class="inline-flex items-center gap-2 text-sm font-semibold px-4 py-2 rounded-xl border border-gray-200 text-gray-800 hover:bg-gray-50 transition"
             aria-label="Buka Instagram Lentera Zyland">
            <i class="fab fa-instagram text-sm opacity-90"></i> Instagram
          </a>
        </div>

        <!-- Mobile menu -->
        <button id="menuBtn" class="md:hidden inline-flex items-center justify-center h-10 w-10 rounded-lg border border-gray-200"
                aria-label="Menu" aria-expanded="false" aria-controls="mobileMenu">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>

    <!-- Mobile panel -->
    <div id="mobileMenu" class="md:hidden hidden border-t border-gray-100 bg-white/95 backdrop-blur">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 grid gap-3">
        <a href="/" class="block py-2 text-gray-800 hover:text-gray-900">Home</a>
        <a href="/berita" class="block py-2 text-gray-800 hover:text-gray-900">Berita</a>
        <a href="/program" class="block py-2 text-gray-800 hover:text-gray-900 font-semibold underline underline-offset-8 decoration-yellow-300">Program</a>
        <a href="/download" class="block py-2 text-gray-800 hover:text-gray-900">Download</a>
        <a href="/tentang" class="block py-2 text-gray-800 hover:text-gray-900">Tentang</a>
        <a href="https://instagram.com/lenterazyland" target="_blank" rel="noopener"
           class="inline-flex items-center gap-2 justify-center text-sm font-semibold px-4 py-2 rounded-xl border border-gray-200 text-gray-800 hover:bg-gray-50 transition mt-2">
          <i class="fab fa-instagram text-sm opacity-90"></i> Instagram
        </a>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero py-10 sm:py-14">
    <div class="blob"></div>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="reveal text-center max-w-3xl mx-auto">
        <span class="inline-flex items-center gap-2 text-xs font-semibold px-3 py-1 rounded-full"
              style="background: rgba(22,163,74,.08); color: var(--primary); border:1px solid rgba(22,163,74,.18);">
          <i class="fas fa-toolbox"></i> Peta Program
        </span>
        <h1 class="mt-3 text-2xl sm:text-3xl font-extrabold text-gray-900">Aktivitas Inklusif, Terstruktur, Seru.</h1>
        <p class="mt-2 text-gray-700">
          Jelajahi paket permainan, AR, lokakarya, dan kompetisi yang ditenagai <strong>Computational Thinking</strong>.
        </p>
        <div class="mt-4 flex flex-wrap justify-center gap-2">
          <span class="chip-ct inline-flex items-center text-xs px-2 py-1 rounded-md border"><i class="fas fa-cut mr-1"></i> Decomposition</span>
          <span class="chip-ct inline-flex items-center text-xs px-2 py-1 rounded-md border"><i class="fas fa-shapes mr-1"></i> Pattern Recognition</span>
          <span class="chip-ct inline-flex items-center text-xs px-2 py-1 rounded-md border"><i class="fas fa-layer-group mr-1"></i> Abstraction</span>
          <span class="chip-ct inline-flex items-center text-xs px-2 py-1 rounded-md border"><i class="fas fa-stream mr-1"></i> Algorithmic Thinking</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Spotlight -->
  <section class="pb-4">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div id="spotlight" class="reveal"></div>
    </div>
  </section>

  <!-- Main -->
  <main class="py-6 sm:py-10 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <!-- Sidebar filter -->
        <aside class="lg:col-span-4">
          <div class="sticky top-20 space-y-4">
            <div class="bg-white p-4 rounded-2xl border border-gray-100">
              <label for="search" class="text-sm font-medium text-gray-900">Cari Program</label>
              <div class="mt-2 relative">
                <input id="search" type="text" placeholder="mis. AR, fokus, guru..."
                  class="w-full rounded-xl border border-gray-200 px-4 py-2.5 pr-9 text-sm focus:outline-none focus:ring-2 focus:ring-yellow-200">
                <i class="fas fa-search absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
              </div>
            </div>

            <div class="bg-white p-4 rounded-2xl border border-gray-100">
              <div class="flex items-center justify-between">
                <h3 class="text-sm font-medium text-gray-900">Kategori</h3>
                <button id="resetFilters" class="text-xs underline text-gray-500">Reset</button>
              </div>
              <div class="mt-3 grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-2 gap-2">
                <button class="chip chip-active text-xs px-3 py-2 rounded-lg border border-gray-200 text-left" data-cat="Semua">Semua</button>
                <button class="chip text-xs px-3 py-2 rounded-lg border border-gray-200 text-left" data-cat="Fun LENTERA">Fun LENTERA</button>
                <button class="chip text-xs px-3 py-2 rounded-lg border border-gray-200 text-left" data-cat="LENTERA Focus">LENTERA Focus</button>
                <button class="chip text-xs px-3 py-2 rounded-lg border border-gray-200 text-left" data-cat="Zylearn">Zylearn</button>
                <button class="chip text-xs px-3 py-2 rounded-lg border border-gray-200 text-left" data-cat="LENTERA Competition">Competition</button>
              </div>
            </div>

            <div class="bg-white p-4 rounded-2xl border border-gray-100">
              <label for="sort" class="text-sm font-medium text-gray-900">Urutkan</label>
              <select id="sort" class="mt-2 w-full rounded-xl border border-gray-200 px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-yellow-200">
                <option value="featured">Pilihan</option>
                <option value="az">A — Z</option>
                <option value="za">Z — A</option>
              </select>
              <button id="toggleAll" class="mt-3 w-full inline-flex items-center justify-center gap-2 text-sm font-semibold px-3 py-2 rounded-xl border border-gray-200 hover:bg-gray-50 transition">
                <i class="fas fa-chevron-down chev"></i> Expand semua
              </button>
            </div>

            <div class="text-sm text-gray-500"><span id="resultCount">0</span> program ditampilkan</div>
          </div>
        </aside>

        <!-- Accordion daftar program -->
        <section class="lg:col-span-8">
          <div id="accordion" class="space-y-4"></div>
        </section>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="border-top border-gray-100 bg-white border-t">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="py-10 grid grid-cols-1 sm:grid-cols-3 gap-8">
        <div class="reveal show">
          <h3 class="font-semibold text-gray-900">Lentera Zyland</h3>
          <p class="mt-2 text-sm text-gray-600">Inovasi pembelajaran inklusif melalui game edukasi berlandaskan Computational Thinking</p>
          <div class="mt-3 flex items-center gap-3 text-gray-500">
            <a href="#" class="hover:text-gray-800" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
            <a href="#" class="hover:text-gray-800" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
            <a href="#" class="hover:text-gray-800" aria-label="TikTok"><i class="fab fa-tiktok"></i></a>
          </div>
        </div>
        <div class="reveal show">
          <h4 class="font-semibold text-gray-900">Navigasi</h4>
          <ul class="mt-2 text-sm text-gray-600 space-y-1">
            <li><a href="/" class="hover:text-gray-900">Home</a></li>
            <li><a href="/berita" class="hover:text-gray-900">Berita</a></li>
            <li><a href="/program" class="hover:text-gray-900">Program</a></li>
            <li><a href="/download" class="hover:text-gray-900">Download</a></li>
            <li><a href="/tentang" class="hover:text-gray-900">Tentang</a></li>
          </ul>
        </div>
        <div class="reveal show">
          <h4 class="font-semibold text-gray-900">Kontak</h4>
          <ul class="mt-2 text-sm text-gray-600 space-y-1">
            <li>Email: <a href="mailto:lenterazyland1@gmail.com" class="underline">lenterazyland1@gmail.com</a></li>
            <li>Alamat: Surakarta</li>
          </ul>
        </div>
      </div>
      <div class="py-4 border-t border-gray-100 text-xs text-gray-500 flex items-center justify-between">
        <span>© <span id="year"></span> Lentera Zyland • All rights reserved.</span>
      </div>
    </div>
  </footer>

  <!-- Script -->
  <script>
    // Tahun footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // Mobile menu
    const menuBtn = document.getElementById('menuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    if(menuBtn){
      menuBtn.addEventListener('click', () => {
        const expanded = menuBtn.getAttribute('aria-expanded') === 'true';
        menuBtn.setAttribute('aria-expanded', String(!expanded));
        mobileMenu.classList.toggle('hidden');
      });
    }

    // ===== Data Program (pakai multi-gambar) =====
    const PROGRAMS = [
      {
        id:"fun-lentera",
        title:"Fun LENTERA",
        category:"Fun LENTERA",
        audience:["Siswa SD", "Slow Learner"],
        excerpt:"Paket permainan AR, Number Board, dan Book Storytime untuk literasi & numerasi yang menyenangkan.",
        ct:["Decomposition","Pattern Recognition","Abstraction","Algorithmic Thinking"],
        points:[
          "AR (Zymath AR) untuk eksplorasi konsep spasial & numerik",
          "Number Board: latihan berhitung bertahap & pengenalan pola",
          "Book Storytime: kosakata & pemahaman membaca"
        ],
        images:["/img/gambar.jpg","/img/gambar.jpg","/img/gambar.jpg"],
        image:"/img/gambar.jpg",
        featured:true
      },
      {
        id:"lentera-focus",
        title:"LENTERA Focus",
        category:"LENTERA Focus",
        audience:["Siswa SD","Remedial/Intervensi"],
        excerpt:"Latih atensi, kontrol impuls, dan kerja sama melalui permainan terstruktur.",
        ct:["Algorithmic Thinking","Decomposition"],
        points:[
          "Permainan aturan bertingkat (level up) untuk ketekunan",
          "Aktivitas berpasangan & tim—kolaborasi & komunikasi",
          "Refleksi singkat di akhir sesi (metakognisi)"
        ],
        images:["/img/gambar.jpg","/img/gambar.jpg"],
        image:"/img/gambar.jpg",
        featured:true
      },
      {
        id:"zylearn",
        title:"Zylearn",
        category:"Zylearn",
        audience:["Guru","Orang Tua"],
        excerpt:"Lokakarya untuk mengadopsi CT dalam pembelajaran & pendampingan anak di rumah.",
        ct:["Decomposition","Pattern Recognition","Abstraction","Algorithmic Thinking"],
        points:[
          "Template aktivitas CT siap pakai untuk kelas/rumah",
          "Strategi diferensiasi untuk kebutuhan beragam",
          "Sesi praktik & micro-teaching"
        ],
        images:["/img/gambar.jpg","/img/gambar.jpg","/img/gambar.jpg","/img/gambar.jpg"],
        image:"/img/gambar.jpg",
        featured:false
      },
      {
        id:"lentera-competition",
        title:"LENTERA Competition",
        category:"LENTERA Competition",
        audience:["Siswa SD","Komunitas"],
        excerpt:"Apresiasi capaian melalui lomba mini bertema CT & numerasi.",
        ct:["Algorithmic Thinking","Pattern Recognition"],
        points:[
          "Tantangan berbasis misi (checkpoints) & rubrik penilaian",
          "Booth demo AR & portofolio karya siswa",
          "Penghargaan & umpan balik yang memotivasi"
        ],
        images:["/img/gambar.jpg","/img/gambar.jpg"],
        image:"/img/gambar.jpg",
        featured:false
      }
    ];

    // ===== Helpers =====
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    const accordion = $('#accordion');
    const spotlight = $('#spotlight');
    const resultCount = $('#resultCount');
    const search = $('#search');
    const sort = $('#sort');
    const chips = $$('.chip');
    const resetFilters = $('#resetFilters');
    const toggleAllBtn = $('#toggleAll');

    const iconByCat = {
      "Fun LENTERA": "fas fa-gamepad",
      "LENTERA Focus": "fas fa-bullseye",
      "Zylearn": "fas fa-chalkboard-teacher",
      "LENTERA Competition": "fas fa-trophy"
    };
    const ctIcon = {
      "Decomposition":"fas fa-cut",
      "Pattern Recognition":"fas fa-shapes",
      "Abstraction":"fas fa-layer-group",
      "Algorithmic Thinking":"fas fa-stream"
    };

    const ctBadge = (name) =>
      `<span class="inline-flex items-center text-xs px-2 py-1 rounded-md bg-gray-50 border border-gray-200 text-gray-700">
        <i class="${ctIcon[name]||''} mr-1"></i>${name}
      </span>`;

    // ===== State =====
    let state = { q:"", cat:"Semua", sort:"featured", expanded:false };
    const galleryIndex = {}; // { [id]: number }

    // ===== Spotlight render =====
    function renderSpotlight(list=PROGRAMS){
      const item = (list.find(p=>p.featured) || list[0]);
      if(!item){ spotlight.innerHTML = ""; return; }
      const cover = (item.images && item.images[0]) || item.image;
      spotlight.innerHTML = `
        <article class="rounded-3xl overflow-hidden border border-gray-100 shadow-sm card-hover relative">
          <div class="absolute inset-0" aria-hidden="true"
               style="background: linear-gradient(to right, rgba(0,0,0,.55), rgba(0,0,0,.15)); z-index:1;"></div>
          <img src="${cover}" alt="${item.title}" class="w-full h-64 sm:h-80 object-cover"/>
          <div class="absolute inset-0 z-10 flex items-end">
            <div class="p-6 sm:p-8 text-white max-w-3xl">
              <div class="flex items-center gap-2 text-xs">
                <span class="inline-flex items-center gap-2 px-2 py-1 rounded-md bg-white/15 backdrop-blur border border-white/20">
                  <i class="${iconByCat[item.category]||'fas fa-layer-group'}"></i> ${item.category}
                </span>
              </div>
              <h2 class="mt-2 text-2xl sm:text-3xl font-extrabold">${item.title}</h2>
              <p class="mt-2 text-sm sm:text-base text-white/90">${item.excerpt}</p>
              <div class="mt-3 flex flex-wrap gap-2">
                ${item.ct.map(ctBadge).join('')}
              </div>
            </div>
          </div>
        </article>
      `;
    }

    // ===== Filtering/Sorting =====
    const getFiltered = () => {
      let items = PROGRAMS.slice();

      if(state.cat !== "Semua"){
        items = items.filter(p => p.category === state.cat);
      }
      if(state.q.trim()){
        const q = state.q.toLowerCase();
        items = items.filter(p =>
          p.title.toLowerCase().includes(q) ||
          p.excerpt.toLowerCase().includes(q) ||
          p.points.some(pt => pt.toLowerCase().includes(q)) ||
          p.audience.join(" ").toLowerCase().includes(q)
        );
      }
      if(state.sort === "az"){
        items.sort((a,b)=> a.title.localeCompare(b.title));
      }else if(state.sort === "za"){
        items.sort((a,b)=> b.title.localeCompare(a.title));
      }else{
        items.sort((a,b)=> (b.featured===true) - (a.featured===true));
      }
      return items;
    };

    // ===== Gallery helpers =====
    function updateGallery(id, idx){
      const container = document.getElementById('gal-'+id);
      if(!container) return;
      const data = PROGRAMS.find(p=>p.id===id);
      if(!data) return;

      galleryIndex[id] = (idx + data.images.length) % data.images.length; // wrap
      const current = galleryIndex[id];

      const hero = container.querySelector('.gal-hero');
      hero.setAttribute('src', data.images[current]);

      container.querySelectorAll('.gal-thumb').forEach((btn, i)=>{
        btn.classList.toggle('thumb-active', i===current);
      });
    }

    // ===== Accordion render =====
    function renderAccordion(){
      const items = getFiltered();
      resultCount.textContent = items.length;

      if(!items.length){
        accordion.innerHTML = `
          <div class="mt-6 text-center text-gray-500">
            <i class="fas fa-puzzle-piece text-3xl mb-3"></i>
            <p>Tidak ada program yang cocok dengan pencarian/filters.</p>
          </div>
        `;
        renderSpotlight([]);
        return;
      }

      renderSpotlight(items);

      accordion.innerHTML = items.map(p => {
        const cover = (p.images && p.images[0]) || p.image;
        galleryIndex[p.id] = 0;

        return `
        <details class="program bg-white reveal show">
          <summary class="list-none cursor-pointer select-none">
            <div class="flex items-start gap-3 p-4 sm:p-5">
              <div class="shrink-0 w-10 h-10 grid place-content-center rounded-lg"
                   style="background: rgba(250,204,21,0.25);">
                <i class="${iconByCat[p.category]||'fas fa-layer-group'} text-yellow-600"></i>
              </div>
              <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2 flex-wrap">
                  <span class="text-[11px] px-2 py-1 rounded-full bg-yellow-50 text-yellow-700 border border-yellow-200">${p.category}</span>
                </div>
                <h3 class="mt-1 font-semibold text-gray-900 text-base sm:text-lg">${p.title}</h3>
                <p class="mt-1 text-sm text-gray-600">${p.excerpt}</p>
              </div>
              <i class="fas fa-chevron-down chev text-gray-400 mt-1"></i>
            </div>
          </summary>

          <!-- panel -->
          <div class="px-4 sm:px-5 pb-5">
            <div class="rounded-xl border border-gray-100 bg-gray-50 p-4">
              <div class="flex flex-wrap gap-2">
                ${p.ct.map(ctBadge).join('')}
              </div>
              <ul class="mt-3 space-y-2 text-sm text-gray-700 list-disc pl-5">
                ${p.points.map(li=>`<li>${li}</li>`).join('')}
              </ul>
              <div class="mt-3 text-xs text-gray-500">Audiens: ${p.audience.join(", ")}</div>
            </div>

            <!-- GALERI BESAR -->
            <div id="gal-${p.id}" class="mt-5">
              <div class="relative rounded-2xl overflow-hidden border border-gray-100">
                <img src="${cover}" alt="${p.title}" class="gal-hero w-full h-80 sm:h-[26rem] object-cover"/>
                <button class="gal-prev absolute left-3 top-1/2 -translate-y-1/2 inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/90 border border-gray-200 shadow-sm hover:bg-white transition" aria-label="Sebelumnya" data-id="${p.id}">
                  <i class="fas fa-chevron-left"></i>
                </button>
                <button class="gal-next absolute right-3 top-1/2 -translate-y-1/2 inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/90 border border-gray-200 shadow-sm hover:bg-white transition" aria-label="Berikutnya" data-id="${p.id}">
                  <i class="fas fa-chevron-right"></i>
                </button>
              </div>
              <!-- Thumbnails -->
              <div class="mt-3 flex gap-2 overflow-x-auto">
                ${p.images.map((src, i)=>`
                  <button class="gal-thumb ${i===0?'thumb-active':''} shrink-0 rounded-xl overflow-hidden border border-gray-200" data-idx="${i}" data-id="${p.id}" aria-label="Gambar ${i+1}">
                    <img src="${src}" alt="Thumb ${i+1} ${p.title}" class="h-16 w-24 object-cover"/>
                  </button>
                `).join('')}
              </div>
            </div>
          </div>
        </details>
      `}).join('');

      $$('.program', accordion).forEach(d => d.open = state.expanded);
      toggleAllBtn.innerHTML = state.expanded
        ? '<i class="fas fa-chevron-up chev"></i> Collapse semua'
        : '<i class="fas fa-chevron-down chev"></i> Expand semua';
    }

    // ===== Events =====
    const debounce = (fn, ms=250) => { let t; return (...args) => { clearTimeout(t); t=setTimeout(()=>fn(...args), ms);} };

    search.addEventListener('input', debounce((e)=>{
      state.q = e.target.value || "";
      state.expanded = false;
      renderAccordion();
    }, 200));

    sort.addEventListener('change', e => {
      state.sort = e.target.value;
      state.expanded = false;
      renderAccordion();
    });

    chips.forEach(ch => {
      ch.addEventListener('click', ()=>{
        chips.forEach(c => c.classList.remove('chip-active'));
        ch.classList.add('chip-active');
        state.cat = ch.dataset.cat;
        state.expanded = false;
        renderAccordion();
      });
    });

    resetFilters.addEventListener('click', ()=>{
      state = { q:"", cat:"Semua", sort:"featured", expanded:false };
      search.value = "";
      sort.value = "featured";
      chips.forEach(c => c.classList.toggle('chip-active', c.dataset.cat === 'Semua'));
      renderAccordion();
    });

    toggleAllBtn.addEventListener('click', ()=>{
      state.expanded = !state.expanded;
      $$('.program', accordion).forEach(d => d.open = state.expanded);
      toggleAllBtn.innerHTML = state.expanded
        ? '<i class="fas fa-chevron-up chev"></i> Collapse semua'
        : '<i class="fas fa-chevron-down chev"></i> Expand semua';
    });

    // Gallery controls
    document.addEventListener('click', (e)=>{
      const prev = e.target.closest('.gal-prev');
      const next = e.target.closest('.gal-next');
      const thumb = e.target.closest('.gal-thumb');

      if(prev){
        const id = prev.dataset.id;
        const data = PROGRAMS.find(p=>p.id===id);
        if(!data) return;
        updateGallery(id, (galleryIndex[id]||0) - 1);
      }
      if(next){
        const id = next.dataset.id;
        const data = PROGRAMS.find(p=>p.id===id);
        if(!data) return;
        updateGallery(id, (galleryIndex[id]||0) + 1);
      }
      if(thumb){
        const id = thumb.dataset.id;
        const idx = +thumb.dataset.idx;
        updateGallery(id, idx);
      }
    });

    // Keyboard nav (saat fokus di tombol galeri)
    document.addEventListener('keydown', (e)=>{
      if(e.key !== 'ArrowLeft' && e.key !== 'ArrowRight') return;
      const focused = document.activeElement;
      if(!focused) return;
      const galBtn = focused.closest('#accordion .gal-prev, #accordion .gal-next, #accordion .gal-thumb');
      if(!galBtn) return;
      const id = galBtn.dataset.id;
      if(!id) return;
      if(e.key === 'ArrowLeft') updateGallery(id, (galleryIndex[id]||0) - 1);
      if(e.key === 'ArrowRight') updateGallery(id, (galleryIndex[id]||0) + 1);
    });

    // Reveal on load
    $$('.reveal').forEach(el => el.classList.add('show'));

    // First render
    renderAccordion();
  </script>
</body>
</html>
